services:

  # Clinical-MDR API service for running tests in pipeline
  api:
    extends:
      file: compose.yaml
      service: api
    build:
      args:
        TARGET: ${BUILD_TARGET:-dev}
    environment:
      UVICORN_RELOAD: "true"
      NEO4J_DSN: "${NEO4J_DSN:-bolt://neo4j:changeme1234@database:7687}/mdrdb"
      OAUTH_ENABLED: "False"
      ALLOW_ORIGIN_REGEX: ".*"
    ports:
      - "${BIND_ADDRESS:-127.0.0.1}:${API_PORT:-8000}:8000"
      - "127.0.0.1:5678:5678"
    volumes:
      - type: bind
        source: ./
        target: /app


networks:
  default:
    driver: external
    name: studybuilder_dev-env
    external: true
